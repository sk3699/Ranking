---
- name: Docker Deploy Playbook
  hosts: MyUbuntu
  tasks:
    #- name: Install Python pip
      #become: yes
      #apt:
         #update_cache: yes
         #name: python3-pip
         #state: latest
    #- name: Install Docker-py python module
      #pip:
         #name: docker
         #state: present
    - name: Remove old skranking images before
      command: docker image prune -af
      ignore_errors: yes
      #shell: |
        #docker rmi -f $(docker images sk3699/skranking)
    - name: Run skranking docker image
      docker_container:
         name: skranking
         pull: true
         image: "sk3699/skranking:{{DockerTag}}"
         state: started
         interactive: true
    #- name: Remove old skranking images
      #docker_prune:
          #images: yes
          #images_filters:
              #dangling: true
              #label: not repository sk3699/skranking
              
    
    #docker image prune -a --filter label!=repository=sk3699/skranking
    #docker rmi -f $(docker images sk3699/skranking)
